{{- $entries := .Page.Scratch.Get "bib" -}}
{{- if $entries -}}
  {{- $entry := where $entries "id" (.Get 0) | first 1 -}}
  {{- if $entry -}}
  <a href="#ref-{{ index $entry 0 "id" }}" class="citation" aria-label="Reference {{ index $entry 0 "id" }}">[{{ $citeKey := .Get 0 }}{{ range $i, $e := $entries }}{{ if eq $e.id $citeKey }}{{ add $i 1 }}{{ end }}{{ end }}]</a>
  {{- else -}}
  <span class="citation-error">[Citation Error]</span>
  {{- end -}}
{{- end -}}
